<div class="payments-container">
    <div class="payments-content payments-row">
        <div class="payments-list">
            <h2>Payments</h2>
            <ul>
                <li *ngFor="let payment of payments">
                    <ng-container *ngIf="isAdmin; else userView">
                        <div class="payment-card">

                            <div><strong>Amount:</strong> {{ payment.amount }}</div>
                            <div>
                                <strong>Status:</strong>
                                <span [ngClass]="{
                                    'status-refunded': payment.status === 'REFUNDED',
                                    'status-successful': payment.status === 'SUCCESSFUL'
                                }">{{ payment.status }}</span>
                            </div>
                            <div><strong>Stripe ID:</strong> {{ payment.stripePaymentId }}</div>
                            <div class="payment-actions">
                                <button (click)="selectPayment(payment)">Edit</button>
                                <button (click)="deletePayment(payment.id!)">Delete</button>
                            </div>
                        </div>
                    </ng-container>
                    <ng-template #userView>
                        <div class="payment-card">
                            <div><strong>Paid:</strong> {{ payment.createdAt ? (payment.createdAt | date:'yyyy-MM-dd') :
                                'N/A' }}</div>
                            <div><strong>Amount:</strong> ${{ payment.amount }}</div>
                            <div>
                                <strong>Status:</strong>
                                <span [ngClass]="{
                                    'status-refunded': payment.status === 'REFUNDED',
                                    'status-successful': payment.status === 'SUCCESSFUL'
                                }">{{ payment.status }}</span>
                            </div>
                        </div>
                    </ng-template>
                </li>
            </ul>
        </div>
        <div class="payments-form-col">
            <div class="payment-form" *ngIf="isAdmin">
                <h3>Add Payment</h3>
                <form (ngSubmit)="createPayment()">
                    <input [(ngModel)]="newPayment.reservation.id" name="reservationId" type="number"
                        placeholder="Reservation ID" required>
                    <input [(ngModel)]="newPayment.amount" name="amount" type="number" placeholder="Amount" required>
                    <input [(ngModel)]="newPayment.currency" name="currency" placeholder="Currency" required>
                    <input [(ngModel)]="newPayment.status" name="status" placeholder="Status" required>
                    <input [(ngModel)]="newPayment.stripePaymentId" name="stripePaymentId"
                        placeholder="Stripe Payment ID">
                    <button type="submit">Add</button>
                </form>
            </div>
            <div *ngIf="selectedPayment && isAdmin" class="edit-payment-form">
                <h3>Edit Payment</h3>
                <form (ngSubmit)="updatePayment()">
                    <input [(ngModel)]="selectedPayment!.reservation.id" name="editReservationId" type="number"
                        required>
                    <input [(ngModel)]="selectedPayment!.amount" name="editAmount" type="number" required>
                    <input [(ngModel)]="selectedPayment!.currency" name="editCurrency" required>
                    <input [(ngModel)]="selectedPayment!.status" name="editStatus" required>
                    <input [(ngModel)]="selectedPayment!.stripePaymentId" name="editStripePaymentId">
                    <button type="submit">Update</button>
                    <button type="button" (click)="selectedPayment = null">Cancel</button>
                </form>
            </div>
        </div>
    </div>
</div>